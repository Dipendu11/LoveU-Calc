<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free Long Division Calculator. Solve math problems step-by-step with remainders or decimals. Visual, accessible, and instant.">
    <title>Long Division Calculator - Step-by-Step Solver</title>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Long Division Calculator",
      "description": "A free online math tool that solves long division problems step-by-step.",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "All",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
    }
    </script>

    <style>
        /* --- 1. CORE SYSTEM STYLES (Performance First) --- */
        :root {
            /* System Colors & Variables */
            --primary: #2563eb; /* System Blue */
            --primary-dark: #1d4ed8;
            --bg-body: #ffffff;
            --bg-surface: #f8fafc;
            --text-main: #0f172a;
            --text-muted: #475569;
            --border: #e2e8f0;
            --focus-ring: rgba(37, 99, 235, 0.2);
            
            /* Calculator Colors */
            --hl-divisor: #0d9488;
            --hl-quotient: #7c3aed;
            --hl-sub: #dc2626;
            
            /* Spacing */
            --container-width: 800px;
            --header-height: 60px;
        }

        /* Dark Mode overrides */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-body: #0f172a;
                --bg-surface: #1e293b;
                --text-main: #f1f5f9;
                --text-muted: #94a3b8;
                --border: #334155;
                --hl-divisor: #2dd4bf;
                --hl-quotient: #a78bfa;
                --hl-sub: #f87171;
            }
        }

        /* Reset & Base */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.5;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- 2. HEADER & NAV --- */
        header {
            height: var(--header-height);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            position: sticky;
            top: 0;
            background: var(--bg-body);
            z-index: 10;
        }

        .brand {
            font-weight: 700;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: var(--text-main);
        }

        .brand svg { width: 24px; height: 24px; fill: #ec4899; }

        .btn-icon {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .btn-icon:hover { background-color: var(--bg-surface); }
        .btn-icon svg { width: 24px; height: 24px; fill: currentColor; }

        /* --- 3. MAIN LAYOUT --- */
        main {
            flex: 1;
            width: 100%;
            max-width: var(--container-width);
            margin: 0 auto;
            padding: 40px 20px;
        }

        h1 {
            font-size: 2rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 10px;
            letter-spacing: -0.03em;
        }

        .subtitle {
            text-align: center;
            color: var(--text-muted);
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* --- 4. CALCULATOR FORM --- */
        .calculator-card {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            font-size: 1.1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-body);
            color: var(--text-main);
            outline: none;
            transition: border-color 0.15s;
        }

        .input-field:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--focus-ring);
        }

        .controls-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .radio-group {
            display: flex;
            gap: 15px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .btn-primary {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .btn-primary:hover { opacity: 0.9; }

        /* --- 5. RESULTS AREA (Prevent CLS) --- */
        #result-container {
            margin-top: 30px;
            /* Essential for CLS: Reserves space so footer doesn't jump */
            min-height: 100px; 
            display: none;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .math-board {
            background: var(--bg-body);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            text-align: center;
            font-family: 'Courier New', Courier, monospace; /* Monospaced is critical for alignment */
            font-weight: 700;
            font-size: 1.2rem;
            white-space: pre; /* Keeps the spaces for alignment */
        }

        /* Syntax Highlighting */
        .hl-div { color: var(--hl-divisor); }
        .hl-quo { color: var(--hl-quotient); }
        .hl-sub { color: var(--hl-sub); }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(37, 99, 235, 0.1);
            border-left: 4px solid var(--primary);
            border-radius: 4px;
            font-size: 0.95rem;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn-nav {
            flex: 1;
            padding: 10px;
            background: var(--bg-body);
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-main);
            font-weight: 600;
        }
        .btn-nav:disabled { opacity: 0.5; cursor: not-allowed; }

        /* --- 6. FOOTER --- */
        footer {
            border-top: 1px solid var(--border);
            padding: 40px 20px;
            text-align: center;
            background: var(--bg-surface);
            margin-top: auto;
        }
        .footer-links a { color: var(--text-muted); margin: 0 10px; text-decoration: none; font-size: 0.9rem; }
        .footer-links a:hover { color: var(--primary); }

        /* --- 7. ACCESSIBILITY / DYSCALCULIA MODE --- */
        .dyscalculia-mode .math-board {
            letter-spacing: 3px;
            line-height: 1.8;
            font-size: 1.4rem;
            background-image: 
                linear-gradient(var(--border) 1px, transparent 1px),
                linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Mobile Adjustments */
        @media (max-width: 600px) {
            .input-grid { grid-template-columns: 1fr; }
            h1 { font-size: 1.75rem; }
        }
    </style>
</head>
<body>

    <header>
        <a href="#" class="brand">
            <svg viewBox="0 0 512 512"><path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84l-12 12-12-12C211.4 51.4 165 36.5 119.3 44.1 50.5 55.5 0 115 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
            iLove Calcs
        </a>
        <button id="themeToggle" class="btn-icon" aria-label="Toggle Dark Mode">
            <svg viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
        </button>
    </header>

    <main>
        <h1>Long Division Calculator</h1>
        <p class="subtitle">Step-by-step solver with Remainders and Decimals.</p>

        <section class="calculator-card">
            <form id="calcForm" onsubmit="event.preventDefault(); startSolver();">
                <div class="input-grid">
                    <div class="form-group">
                        <label for="dividend">Dividend (Number)</label>
                        <input type="number" id="dividend" class="input-field" placeholder="e.g. 1500" required step="any">
                    </div>
                    <div class="form-group">
                        <label for="divisor">Divisor (Divide by)</label>
                        <input type="number" id="divisor" class="input-field" placeholder="e.g. 12" required step="any">
                    </div>
                </div>

                <div class="controls-row">
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="mode" value="remainder" checked> Remainder
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="mode" value="decimal"> Decimal
                        </label>
                    </div>
                    <div class="radio-group" style="margin-left: auto;">
                        <label class="radio-label">
                            <input type="checkbox" id="dyscalculiaToggle"> Access Mode
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn-primary">Solve Step-by-Step</button>
            </form>

            <div id="result-container">
                <div id="mathBoard" class="math-board"></div>
                <div id="explanation" class="explanation"></div>
                <div class="nav-buttons">
                    <button class="btn-nav" id="btnPrev" onclick="changeStep(-1)" disabled>Previous</button>
                    <button class="btn-nav" id="btnNext" onclick="changeStep(1)" disabled>Next Step</button>
                </div>
            </div>
        </section>

        <article style="margin-top: 60px; line-height: 1.7; color: var(--text-muted);">
            <h2 style="color: var(--text-main); margin-bottom: 15px;">How to do Long Division</h2>
            <p style="margin-bottom: 15px;">Long division is a standard division algorithm suitable for dividing multi-digit numbers. It breaks down a division problem into a series of easier steps: divide, multiply, subtract, and bring down.</p>
            <h3 style="color: var(--text-main); font-size: 1.1rem; margin-bottom: 10px;">The 4 Steps:</h3>
            <ul style="padding-left: 20px; margin-bottom: 20px;">
                <li><strong>Divide:</strong> Divide the current number by the divisor.</li>
                <li><strong>Multiply:</strong> Multiply the result by the divisor.</li>
                <li><strong>Subtract:</strong> Subtract the product from the current number.</li>
                <li><strong>Bring Down:</strong> Bring down the next digit.</li>
            </ul>
        </article>
    </main>

    <footer>
        <div style="font-weight: 700; margin-bottom: 10px;">iLove Calcs</div>
        <div class="footer-links">
            <a href="#">Home</a>
            <a href="#">Privacy</a>
            <a href="#">Contact</a>
        </div>
        <div style="margin-top: 20px; font-size: 0.8rem; color: var(--text-muted);">&copy; 2024 iLove Calcs. No external trackers.</div>
    </footer>

    <script>
        // --- 1. THEME LOGIC ---
        const toggleBtn = document.getElementById('themeToggle');
        toggleBtn.addEventListener('click', () => {
            const isDark = document.body.style.backgroundColor === 'var(--bg-body)'; // Simple check
            // We rely on CSS media query for default, but this adds a class override if needed. 
            // For simplicity and performance, we toggle a meta tag or simple class.
            document.documentElement.style.colorScheme = document.documentElement.style.colorScheme === 'dark' ? 'light' : 'dark';
        });

        // --- 2. CALCULATOR LOGIC ---
        let steps = [];
        let currentStep = 0;

        function cleanNum(num) { return parseFloat(num.toFixed(10)); }

        function startSolver() {
            const dividend = Math.abs(parseFloat(document.getElementById('dividend').value));
            const divisor = Math.abs(parseFloat(document.getElementById('divisor').value));
            const mode = document.querySelector('input[name="mode"]:checked').value;
            const isAccessMode = document.getElementById('dyscalculiaToggle').checked;

            if (!dividend || !divisor) return;
            if (divisor === 0) { alert("Cannot divide by zero"); return; }

            // Toggle Access Mode Class
            const board = document.getElementById('mathBoard');
            if(isAccessMode) board.classList.add('dyscalculia-mode');
            else board.classList.remove('dyscalculia-mode');

            // Generate Steps
            steps = generateSteps(dividend, divisor, mode === 'decimal');
            currentStep = 0;
            
            // Show UI
            document.getElementById('result-container').style.display = 'block';
            renderStep();
        }

        function generateSteps(dividend, divisor, useDecimals) {
            let log = [];
            let divStr = dividend.toString();
            let digits = divStr.includes('.') ? divStr.replace('.', '').split('').map(Number) : divStr.split('').map(Number);
            
            let quotient = "";
            let remainder = 0;
            let visualRows = [];
            let decimalAdded = false;

            // Step 0: Setup
            log.push({ text: `Let's set up the problem: ${dividend} รท ${divisor}`, rows: [], q: "" });

            let i = 0;
            let maxLoops = 0;
            
            // Main Loop
            while (true) {
                // Decimal Logic
                if (i >= digits.length) {
                    if (remainder === 0) break;
                    if (!useDecimals) break;
                    if (quotient.includes('.') && quotient.split('.')[1].length >= 3) break; // Max 3 decimals
                    
                    digits.push(0);
                    if (!decimalAdded) { quotient += "."; decimalAdded = true; }
                }

                let digit = digits[i];
                let currentVal = cleanNum((remainder * 10) + digit);

                // "Bring Down" Visualization
                if (i > 0) {
                    let tempRows = JSON.parse(JSON.stringify(visualRows));
                    // Remove the last remainder row to replace it with the "brought down" version
                    if(tempRows.length > 0 && tempRows[tempRows.length-1].type === 'rem') tempRows.pop();
                    
                    tempRows.push({ val: currentVal, indent: i, type: 'bring' });
                    log.push({ 
                        text: `Bring down the ${digit} to make ${currentVal}.`, 
                        rows: tempRows, q: quotient 
                    });
                    visualRows = tempRows;
                }

                // Math
                let count = Math.floor(currentVal / divisor);
                let product = count * divisor;
                let newRemainder = currentVal - product;

                quotient += count;

                // Visual Rows Update
                let stepRows = JSON.parse(JSON.stringify(visualRows));
                // If it's a bring down step, we just did that. Now we multiply.
                
                stepRows.push({ val: product, indent: i, type: 'sub' });
                
                log.push({ 
                    text: `${divisor} goes into ${currentVal}, ${count} times. (${count} ร ${divisor} = ${product})`, 
                    rows: stepRows, q: quotient 
                });

                // Subtraction Step
                let subRows = JSON.parse(JSON.stringify(stepRows));
                subRows.push({ val: newRemainder, indent: i, type: 'rem' });
                
                log.push({ 
                    text: `Subtract: ${currentVal} - ${product} = ${newRemainder}`, 
                    rows: subRows, q: quotient 
                });

                visualRows = subRows;
                remainder = newRemainder;
                i++;
                maxLoops++;
                if (maxLoops > 50) break; // Safety Break
            }

            // Final Result Step
            let finalQ = quotient;
            if(!finalQ.startsWith('0.')) finalQ = finalQ.replace(/^0+/, '');
            if(finalQ === '') finalQ = '0';
            
            let finalText = `Answer: ${finalQ}`;
            if (!useDecimals && remainder > 0) finalText += ` R ${remainder}`;

            log.push({ text: finalText, rows: visualRows, q: quotient, done: true });
            return log;
        }

        function renderStep() {
            const data = steps[currentStep];
            const board = document.getElementById('mathBoard');
            const explanation = document.getElementById('explanation');
            const dividend = document.getElementById('dividend').value;
            const divisor = document.getElementById('divisor').value;

            // Update Text
            explanation.innerText = data.text;

            // Render Board (US Notation)
            let html = "";
            let qStr = data.q.replace(/^0+/, '') || (currentStep > 0 ? "0" : ""); 
            
            // Header:   12
            //         ______
            //       5 ) 60
            let indent = divisor.length + 2; 
            html += " ".repeat(indent) + `<span class="hl-quo">${qStr}</span>\n`;
            html += " ".repeat(indent) + "_".repeat(Math.max(dividend.length, qStr.length)) + "\n";
            html += `<span class="hl-div">${divisor}</span> ) ${dividend}\n`;

            // Body
            data.rows.forEach(row => {
                // Calculate spacing based on indentation index
                // Note: This logic is simplified for the demo. In a complex app, exact character mapping is needed.
                let pad = indent + row.indent; 
                
                if (row.type === 'sub') {
                    // Logic to right-align the subtraction under the specific digit
                    // For the sake of this zero-dependency demo, we use a simplified alignment
                    let valStr = row.val.toString();
                    let localPad = pad - (valStr.length - 1); 
                    html += " ".repeat(localPad) + `<span class="hl-sub">- ${valStr}</span>\n`;
                    html += " ".repeat(localPad) + "-".repeat(valStr.length + 1) + "\n";
                } else if (row.type === 'rem' || row.type === 'bring') {
                    let valStr = row.val.toString();
                    let localPad = pad - (valStr.length - 1);
                    html += " ".repeat(localPad) + valStr + "\n";
                }
            });

            board.innerHTML = html;

            // Button State
            document.getElementById('btnPrev').disabled = (currentStep === 0);
            document.getElementById('btnNext').disabled = (currentStep === steps.length - 1);
        }

        function changeStep(dir) {
            currentStep += dir;
            renderStep();
        }
    </script>
</body>
</html>
